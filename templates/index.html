<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mini Compiler</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.12/codemirror.min.css" />
  <link rel="stylesheet" href="https://unpkg.com/aos@2.3.1/dist/aos.css" />

  <style>
    /* Dark mode styles */
    body.dark-mode {
      background-color: #121212;
      color: #eee;
    }
    body.dark-mode .info-card, 
    body.dark-mode .editor-card, 
    body.dark-mode .footer, 
    body.dark-mode header.hero {
      background-color: #1e1e1e;
      box-shadow: none;
    }
    body.dark-mode .CodeMirror {
      background: #1e1e1e;
      color: #eee;
    }

    /* Output box styles */
    .output-box {
      background-color: #f0f0f0;
      padding: 1em;
      max-height: 200px;
      overflow-y: auto;
      font-family: monospace;
      white-space: pre-wrap;
      border-radius: 5px;
      border: 1px solid #ccc;
      min-height: 80px;
      user-select: text;
    }
    body.dark-mode .output-box {
      background-color: #333;
      color: #ddd;
      border-color: #555;
    }

    /* Collapsible card styles */
    .collapsible {
      background-color: #eee;
      color: #444;
      cursor: pointer;
      padding: 1em;
      width: 100%;
      border: none;
      text-align: left;
      outline: none;
      font-size: 1.2em;
      border-radius: 5px;
      margin-top: 0.5em;
      transition: background-color 0.3s ease;
    }
    .collapsible:hover {
      background-color: #ccc;
    }
    .collapsible.active {
      background-color: #ccc;
    }
    .collapsible-content {
      padding: 0 1em;
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
      background-color: white;
      border-radius: 0 0 5px 5px;
      box-shadow: inset 0 0 5px #aaa;
      margin-bottom: 1em;
    }
    body.dark-mode .collapsible {
      background-color: #333;
      color: #ddd;
    }
    body.dark-mode .collapsible:hover,
    body.dark-mode .collapsible.active {
      background-color: #555;
    }
    body.dark-mode .collapsible-content {
      background-color: #222;
      box-shadow: inset 0 0 5px #000;
    }

    /* Button styles */
    .btn-sample {
      margin-left: 10px;
      padding: 0.3em 0.6em;
      font-size: 0.9em;
      cursor: pointer;
      border-radius: 4px;
      border: 1px solid #007BFF;
      background-color: #007BFF;
      color: white;
      transition: background-color 0.3s ease;
    }
    .btn-sample:hover {
      background-color: #0056b3;
      border-color: #0056b3;
    }
  </style>
</head>
<body>
  <header class="hero" data-aos="fade-down">
    <h1>✨ Mini Compiler ✨</h1>
    <p>Type code, compile it, and understand how compilers work — live in your browser!</p>

    <!-- Dark mode toggle -->
    <label style="cursor:pointer; user-select:none;">
      <input type="checkbox" id="darkModeToggle" /> Dark Mode
    </label>

    <a href="#try-it" class="btn" style="margin-left: 20px;">Try It Yourself ↓</a>
  </header>

  <section class="info-card" data-aos="fade-up">
    <h2> About This Project</h2>
    <p>This compiler is a project built using Python, Flask, and PLY. It teaches how real compilers tokenize, parse, and evaluate code by providing live feedback in a fun interface.</p>
  </section>

  <!-- Collapsible How It Works Section -->
  <section class="info-card" data-aos="fade-up">
    <button class="collapsible">How It Works</button>
    <div class="collapsible-content">
      <ul>
        <li><strong>Lexical Analysis:</strong> Breaks code into tokens like variables and operators.</li>
        <li><strong>Parsing:</strong> Checks if the code follows grammar rules.</li>
        <li><strong>Semantic Analysis:</strong> Evaluates correctness and executes the logic.</li>
      </ul>
    </div>
  </section>

  <section id="try-it" class="editor-card" data-aos="fade-up">
    <h2>Try the Compiler</h2>

    <!-- Load sample code buttons -->
    <button class="btn-sample" data-sample="
    a = 5 
    b = 10
    c = a + b">Load Sample 1</button>
    <button class="btn-sample" data-sample="
    x = 7
    y = x * 3
    z = y - 1">Load Sample 2</button>

    <form method="POST" id="compileForm" style="margin-top: 1em;">
      <textarea id="code" name="code">{{ request.form.code or 'a = 5\nb = 10\nc = a + b' }}</textarea><br>
      <button type="submit" class="btn">Compile</button>
    </form>

    <h3> Output</h3>
    <pre class="output-box" id="output-box"></pre>
  </section>

  <section class="info-card" data-aos="fade-up">
    <h2>Meet the Team</h2>
    <ul>
      <li><strong>Shriya</strong> – Grammar Designer & Parser Developer</li>
      <li><strong>Riya</strong> – Lexer Developer</li>
      <li><strong>Niharika</strong> – Semantic Checker & IR Testing</li>
      <li><strong>Siddhi</strong> – Web Developer & UI Integration</li>
    </ul>
  </section>

  <footer class="footer" data-aos="fade-up">
    <p>Made with ❤️ by Team SyntaxToExecution | CD Project</p>
  </footer>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.12/codemirror.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.12/mode/python/python.min.js"></script>
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script>
    AOS.init();

    // Initialize CodeMirror editor
    var editor = CodeMirror.fromTextArea(document.getElementById("code"), {
      lineNumbers: true,
      mode: "python",
      theme: "default"
    });

    // Dark mode toggle
    const darkModeToggle = document.getElementById('darkModeToggle');
    darkModeToggle.addEventListener('change', () => {
      document.body.classList.toggle('dark-mode', darkModeToggle.checked);
    });

    // Load sample code buttons
    const sampleButtons = document.querySelectorAll('.btn-sample');
    sampleButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        editor.setValue(btn.getAttribute('data-sample'));
      });
    });

    // Collapsible cards
    const collapsibles = document.querySelectorAll('.collapsible');
    collapsibles.forEach(button => {
      button.addEventListener('click', () => {
        button.classList.toggle('active');
        const content = button.nextElementSibling;
        if (content.style.maxHeight){
          content.style.maxHeight = null;
        } else {
          content.style.maxHeight = content.scrollHeight + "px";
        } 
      });
    });

    // Typing animation for output
    function typeOutput(text, element, speed = 30) {
      element.textContent = '';
      let i = 0;
      function typing() {
        if (i < text.length) {
          element.textContent += text.charAt(i);
          i++;
          setTimeout(typing, speed);
        }
      }
      typing();
    }

    // On page load, animate the existing output text from Flask variable
    const outputText = `{{ output | replace('\n', '\\n') | replace('\r', '') | safe }}`;
    const outputBox = document.getElementById('output-box');
    if(outputText.trim()) {
      typeOutput(outputText, outputBox);
    }

    
  </script>
</body>
</html>



